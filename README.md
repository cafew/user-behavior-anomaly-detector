## About

User anomaly detector based on logs generated by Osquery framework and machine learning to process those logs.
Machine learnings alogirthms that are currently implemented are: Recurrent neural network - Long short-term memory (LSTM)
and One-Class Support Vector Machine (OCSVM). This project is part of Master thesis at Faculty of electrical engineering and computing, University of Zagreb.

Note: Only Linux platforms are supported. Tested on XUbuntu 16.04.

## Motivation

Existing security solutions are mostly based on preventing known malicious threats or a defined set of rules and therefore most outside and inside threats end as successful attacks.
The idea was to build a system that is an adaptive user action identifier, so it can predict and detect anomalous behavior in real time.

## Installation

###### osquery
- Download [osquery](https://osquery.io/downloads/).
- Get osquery pack of queries file [here](https://gist.github.com/morrigan/51343a6b879643f706d761137a8f90e2).
- Get osquery configuration file [here](https://gist.github.com/morrigan/f1f36064dac5a9fd5b2a121c906ada67).

Place both files in osquery directory which is usually `/etc/osquery/` or `/usr/local/`.

###### Repository

- Download the repository using `git clone`.
- Install pip requirements with the following command: `pip install -r requirements.txt`.
Python 2.7 is required. I don't guarantee that everything works with Python 3+ but please feel free to try.

## How to use

- Start osquery first i.e. `sudo service osqueryd start`.
- You can start the program by choosing the wanted algorithms i.e. `python main.py -a OCSVM`.
    Default algorithm is LSTM. You can also change the queries result log file using the `-l` flag, default is `/var/log/osquery/osqueryd.results.log`.

## License

[The MIT License](https://opensource.org/licenses/mit) Copyright (c) 2017-present